\begin{figure}[t]
\begin{small}
\begin{verbatim}
interface PubSub {
  command result_t publish(uint16_t chan);
  command result_t subscribe(uint16_t chan);
  command result_t leave(uint16_t chan);

  command result_t send(uint16_t channel, 
      uint8_t length, TOS_Msg* msg);
  event result_t sendDone(TOS_MsgPtr msg, 
      result_t success);

  event TOS_MsgPtr receive(TOS_MsgPtr m, 
      uint16_t channel, uint16_t srcAddr);
}
\end{verbatim}
\end{small}
\caption{{\small\bf The TinyADMR software interface.}}
\label{fig-interface}
\end{figure}

% \begin{figure}
% \begin{footnotesize}
% \begin{verbatim}
% interface PubSub { 
%   command result_t publish(uint16_t groupAddr);
%   command result_t subscribe(uint16_t groupAddr); 
%   command result_t leave(uint16_t groupAddr);
% }
% 
% interface SendMsg { 
%   command result_t send(uint16_t groupAddr, 
%     uint8_t length, TOS_MsgPtr msg);
%   event result_t sendDone(TOS_MsgPtr msg, 
%     result_t success);
% }
% 
% interface ReceiveMsg {
%   event TOS_MsgPtr receive(TOS_MsgPtr m);
% }
% \end{verbatim}
% \end{footnotesize}
% \caption{\small {\bf Interfaces provided by TinyADMR: PubSub, 
% SendMsg and ReceiveMsg.} {\em PubSub supports the Publish/Subscribe 
% membership related functions. SendMsg and ReceiveMsg appear as 
% standard TinyOS SendMsg and ReceiveMsg interface except address
% means group address rather than individual node address.}}
% \label{fig-interface}
% \end{figure}

%  command void* getBuffer(TOS_MsgPtr msg, uint16_t* length);
%  command bool isPublisher(uint16_t groupAddr);
%  command bool isSubscriber(uint16_t groupAddr);
